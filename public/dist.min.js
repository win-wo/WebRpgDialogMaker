app=angular.module("WebRpgDialogMaker",["ngRoute"]),app.config(["$compileProvider",function(t){t.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|data):/)}]),app.config(["$routeProvider",function(t){t.when("/chapter",{templateUrl:"public/modules/chapters/index.html",controller:"ChapterPageController",controllerAs:"ChapterPage"}).otherwise({redirectTo:"/chapter"})}]),function(){function t(){var t=this;t.appName="Project Chaptr"}app.controller("AppController",t)}(),app.Data={},app.Models={},app.Utils={},app.Models.Chapter=function(){function t(t){t?this.DataContructor(t):this.Constructor()}return t.prototype.Constructor=function(){this.id=app.Utils.Guid.newGuid(),this.name=null,this.number=null,this.language=null,this.dialogs=[]},t.prototype.DataContructor=function(t){this.id=t.id,this.name=t.name,this.number=t.number,this.language=t.language,this.dialogs=t.dialogs},t.prototype.isValid=function(){if(!this.id)throw new Error("Missing id");if(!this.name)throw new Error("Missing name");if(!this.number)throw new Error("Missing number");if(!this.language)throw new Error("Missing language");if(!this.dialogs)throw new Error("Missing dialogs")},t.prototype.getFileName=function(){return this.number+"."+this.language+"."+app.Utils.Slug.slugify(this.name)+".json"},t}(),function(){function t(t){function a(){try{return JSON.parse(localStorage.chapter)}catch(t){return null}}function i(){localStorage.chapter=JSON.stringify(o.chapterData.chapter)}function e(t){try{var a=JSON.parse(t),e=new app.Models.Chapter(a);e.isValid(),o.chapterData.chapter=e,i(),location.reload()}catch(r){app.Data.Notifications.add("danger","File is not valid : "+r.message)}}var o=this;o.chapterData=app.Data.Chapter,o.chapterData.chapter=new app.Models.Chapter(a()),o.file=null,o.serializedChapterForExport=null,o.serializedChapterForVisualisation=null,o.exportedFileName=null,o.saveToStorage=function(){i()},o.importChapter=function(){try{var t=angular.element("#toolbar-file-import")[0];if(0==t.files.length)throw new Error("No file selected");var a=t.files[0],i=new FileReader;i.onload=function(t){e(i.result)},i.readAsText(a)}catch(o){app.Data.Notifications.add("danger","Impossible to import : "+o.message)}},o.exportChapter=function(){try{o.serializedChapterForExport=encodeURIComponent(JSON.stringify(o.chapterData.chapter)),o.exportedFileName=o.chapterData.chapter.getFileName()}catch(t){app.Data.Notifications.add("danger","Error while exporting : "+t.message)}},o.resetChapter=function(){o.chapterData.chapter=new app.Models.Chapter},o.updateSerializedChapterForVisualisation=function(){o.serializedChapterForVisualisation=JSON.stringify(o.chapterData.chapter,void 0,2)}}app.controller("ChapterPageController",t),t.$inject=["$location"]}(),app.Data.Chapter={},app.Data.Notifications={data:[],add:function(t,a){this.list.push({type:t,message:a})}},app.Models.Dialog=function(){function t(t){t?this.DataContructor(t):this.Constructor()}return t.prototype.Constructor=function(){this.id=app.Utils.Guid.newGuid(),this.name=null,this.number=null,this.messages=[]},t.prototype.DataContructor=function(t){this.id=t.id,this.name=t.name,this.number=t.number,this.messages=t.messages},t}(),function(){function t(){var t=this;t.chapterData=app.Data.Chapter,t.dialogModal={id:"#dialogModal",dialog:{}},t.showDialogModal=function(a){t.dialogModal.dialog=new app.Models.Dialog(a),$(t.dialogModal.id).modal()},t.saveDialog=function(a){var i=new app.Models.Dialog(a),e=_.findIndex(t.chapterData.chapter.dialogs,{id:i.id});-1!=e?t.chapterData.chapter.dialogs[e]=i:t.chapterData.chapter.dialogs.push(i),$(t.dialogModal.id).modal("hide")},t.duplicateDialog=function(a){a.id=app.Utils.Guid.newGuid();var i=new app.Models.Dialog(a),e=_.findIndex(t.chapterData.chapter.dialogs,{id:i.id});t.chapterData.chapter.dialogs.splice(e,0,i)},t.deleteDialog=function(a){_.remove(t.chapterData.chapter.dialogs,{id:a.id})},t.demoDialog=function(t){}}app.controller("DialogListController",t)}(),function(){function t(){var t=this;t.notifications=app.Data.Notifications.data,t.removeNotification=function(a){t.notifications.splice(a,1)}}app.controller("NotificationsController",t)}(),function(){function t(){}app.controller("ToolbarController",t)}(),app.Utils.Guid=function(){function t(){}return t.newGuid=function(){var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var a=16*Math.random()|0,i="x"==t?a:3&a|8;return i.toString(16)});return t},t}(),app.Utils.Slug=function(){function t(){}return t.slugify=function(t){return t.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")},t}();
//# sourceMappingURL=dist.min.js.map
