app=angular.module("WebRpgDialogMaker",["ngRoute"]),app.config(["$compileProvider",function(t){t.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|data):/)}]),app.config(["$routeProvider",function(t){t.when("/chapters/manage",{templateUrl:"public/modules/chapters/manageChapter.html",controller:"ManageChapterController",controllerAs:"ManageChapter"}).otherwise({redirectTo:"/chapters/manage"})}]),function(){function t(){var t=this;t.appName="Project Chaptr"}app.controller("AppController",t)}(),app.Data={},app.Models={},app.Utils={},app.Models.Chapter=function(){function t(t){t?this.DataContructor(t):this.Constructor()}return t.prototype.Constructor=function(){this.id=app.Data.Guid.newGuid(),this.name=null,this.number=null,this.language=null,this.dialogs=[]},t.prototype.DataContructor=function(t){this.id=t.id,this.name=t.name,this.number=t.number,this.language=t.language,this.dialogs=t.dialogs},t.prototype.isValid=function(){if(!this.id)throw new Error("Missing id");if(!this.name)throw new Error("Missing name");if(!this.number)throw new Error("Missing number");if(!this.language)throw new Error("Missing language");if(!this.dialogs)throw new Error("Missing dialogs")},t.prototype.getFileName=function(){return this.number+"."+this.language+"."+app.Utils.Slug.slugify(this.name)+".json"},t}(),function(){function t(t){function a(){try{return JSON.parse(localStorage.chapter)}catch(t){return null}}function i(){localStorage.chapter=JSON.stringify(o.chapter)}function e(t){try{var a=JSON.parse(t),e=new app.Models.Chapter(a);e.isValid(),o.chapter=e,i()}catch(n){app.Data.Notifications.add("danger","File is not valid : "+n.message)}}var o=this;o.chapter=new app.Models.Chapter(a()),o.dialogModal={id:"#dialogModal",dialog:{}},o.file=null,o.serializedChapterForExport=null,o.serializedChapterForVisualisation=null,o.exportedFileName=null,o.showDialogModal=function(t){angular.copy(t,o.dialogModal.dialog),$(o.dialogModal.id).modal()},o.saveDialog=function(t){var a={};angular.copy(t,a),a.id=a.id||app.Utils.Guid.newGuid();var i=_.findIndex(o.chapter.dialogs,{id:a.id});-1!=i?o.chapter.dialogs[i]=a:o.chapter.dialogs.push(a),$(o.dialogModal.id).modal("hide")},o.selectDialog=function(t){o.updateDialogWindowVisible,angular.copy(t,o.dialogModal.dialog)},o.deleteDialog=function(t){_.remove(o.chapter.dialogs,{id:t.id})},o.demoDialog=function(t){},o.saveToStorage=function(){i()},o.importChapter=function(){try{var t=angular.element("#toolbar-file-import")[0];if(0==t.files.length)throw new Error("No file selected");var a=t.files[0],i=new FileReader;i.onload=function(t){e(i.result)},i.readAsText(a)}catch(o){app.Data.Notifications.add("danger","Impossible to import : "+o.message)}},o.exportChapter=function(){try{o.serializedChapterForExport=encodeURIComponent(JSON.stringify(o.chapter)),o.exportedFileName=o.chapter.getFileName()}catch(t){app.Data.Notifications.add("danger","Error while exporting : "+t.message)}},o.resetChapter=function(){o.chapter=new app.Models.Chapter},o.updateSerializedChapterForVisualisation=function(){o.serializedChapterForVisualisation=JSON.stringify(o.chapter,void 0,2)}}app.controller("ManageChapterController",t),t.$inject=["$location"]}(),app.Data.Notifications={list:[],add:function(t,a){this.list.push({type:t,message:a})}},function(){function t(){var t=this;t.notifications=app.Data.Notifications.list,t.removeNotification=function(a){t.notifications.splice(a,1)}}app.controller("NotificationsController",t)}(),app.Utils.Guid=function(){function t(){}return t.newGuid=function(){var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var a=16*Math.random()|0,i="x"==t?a:3&a|8;return i.toString(16)});return t},t}(),app.Utils.Slug=function(){function t(){}return t.slugify=function(t){return t.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")},t}(),function(){function t(){}app.controller("ToolbarController",t)}();
//# sourceMappingURL=dist.min.js.map
