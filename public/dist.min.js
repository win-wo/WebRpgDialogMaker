app=angular.module("WebRpgDialogMaker",["ngRoute"]),app.config(["$compileProvider",function(t){t.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|data):/)}]),app.config(["$routeProvider",function(t){t.when("/chapters/manage",{templateUrl:"public/modules/chapters/manageChapter.html",controller:"ManageChapterController",controllerAs:"ManageChapter"}).otherwise({redirectTo:"/chapters/manage"})}]),function(){function t(){var t=this;t.appName="Project Chaptr"}app.controller("AppController",t)}(),function(){function t(t,i){function e(t){t?this.DataContructor(t):this.Constructor()}return e.prototype.Constructor=function(){this.id=t.newGuid(),this.name=null,this.number=null,this.language=null,this.dialogs=[]},e.prototype.DataContructor=function(t){this.id=t.id,this.name=t.name,this.number=t.number,this.language=t.language,this.dialogs=t.dialogs},e.prototype.isValid=function(){if(!this.id)throw new Error("Missing id");if(!this.name)throw new Error("Missing name");if(!this.number)throw new Error("Missing number");if(!this.language)throw new Error("Missing language");if(!this.dialogs)throw new Error("Missing dialogs")},e.prototype.getFileName=function(){return this.number+"."+this.language+"."+i.slugify(this.name)+".json"},e}app.factory("Chapter",t),t.$inject=["Guid","Slug"]}(),function(){function t(t,i,e,o){function a(){try{return JSON.parse(localStorage.chapter)}catch(t){return null}}function n(){localStorage.chapter=JSON.stringify(l.chapter)}function r(t){try{var o=JSON.parse(t),a=new i(o);a.isValid(),l.chapter=a,n()}catch(r){e.add("danger","File is not valid : "+r.message)}}var l=this;l.chapter=new i(a()),l.dialogModal={id:"#dialogModal",dialog:{}},l.file=null,l.serializedChapterForExport=null,l.serializedChapterForVisualisation=null,l.exportedFileName=null,l.showDialogModal=function(t){angular.copy(t,l.dialogModal.dialog),$(l.dialogModal.id).modal()},l.saveDialog=function(t){var i={};angular.copy(t,i),i.id=i.id||o.newGuid();var e=_.findIndex(l.chapter.dialogs,{id:i.id});-1!=e?l.chapter.dialogs[e]=i:l.chapter.dialogs.push(i),$(l.dialogModal.id).modal("hide")},l.selectDialog=function(t){l.updateDialogWindowVisible,angular.copy(t,l.dialogModal.dialog)},l.deleteDialog=function(t){_.remove(l.chapter.dialogs,{id:t.id})},l.demoDialog=function(t){},l.saveToStorage=function(){n()},l.importChapter=function(){try{var t=angular.element("#toolbar-file-import")[0];if(0==t.files.length)throw new Error("No file selected");var i=t.files[0],o=new FileReader;o.onload=function(t){r(o.result)},o.readAsText(i)}catch(a){e.add("danger","Impossible to import : "+a.message)}},l.exportChapter=function(){try{l.serializedChapterForExport=encodeURIComponent(JSON.stringify(l.chapter)),l.exportedFileName=l.chapter.getFileName()}catch(t){e.add("danger","Error while exporting : "+t.message)}},l.resetChapter=function(){l.chapter=new i},l.updateSerializedChapterForVisualisation=function(){l.serializedChapterForVisualisation=JSON.stringify(l.chapter,void 0,2)}}app.controller("ManageChapterController",t),t.$inject=["$location","Chapter","NotificationsRepository","Guid"]}(),app.factory("NotificationsRepository",function(){var t={list:[],add:function(i,e){t.list.push({type:i,message:e})}};return t}),function(){function t(t){var i=this;i.notifications=t.list,i.removeNotification=function(t){i.notifications.splice(t,1)}}app.controller("NotificationsController",t),t.$inject=["NotificationsRepository"]}(),function(){function t(){}app.controller("ToolbarController",t)}(),function(){app.factory("Guid",function(){return{newGuid:function(){var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var i=16*Math.random()|0,e="x"==t?i:3&i|8;return e.toString(16)});return t}}})}(),function(){app.factory("Slug",function(){return{slugify:function(t){return t.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")}}})}();
//# sourceMappingURL=dist.min.js.map
