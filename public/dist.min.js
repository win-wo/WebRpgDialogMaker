app=angular.module("WebRpgDialogMaker",["ngRoute"]),app.config(["$compileProvider",function(i){i.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|data):/)}]),app.config(["$routeProvider",function(i){i.when("/edit",{templateUrl:"public/modules/chapter/index.html",controller:"EditChapterController",controllerAs:"EditChapter"}).otherwise({redirectTo:"/edit"})}]),function(){function i(){var i=this;i.appName="Project Chaptr"}app.controller("AppController",i)}(),function(){function i(i,t){function o(i){i?this.DataContructor(i):this.Constructor()}return o.prototype.Constructor=function(){this.id=i.newGuid(),this.name=null,this.number=null,this.language=null,this.dialogs=[]},o.prototype.DataContructor=function(i){this.id=i.id,this.name=i.name,this.number=i.number,this.language=i.language,this.dialogs=i.dialogs},o.prototype.isValid=function(){if(!this.id)throw new Error("Missing id");if(!this.name)throw new Error("Missing name");if(!this.number)throw new Error("Missing number");if(!this.language)throw new Error("Missing language");if(!this.dialogs)throw new Error("Missing dialogs")},o.prototype.getFileName=function(){return this.number+"."+this.language+"."+t.slugify(this.name)+".json"},o}app.factory("Chapter",i),i.$inject=["Guid","Slug"]}(),function(){function i(i,t,o,e){function r(){try{return JSON.parse(localStorage.chapter)}catch(i){return null}}function n(){localStorage.chapter=JSON.stringify(l.chapter)}function a(i){try{var e=JSON.parse(i),r=new t(e);r.isValid(),l.chapter=r,n()}catch(a){o.add("danger","File is not valid : "+a.message)}}var l=this;l.chapter=new t(r()),l.dialogModal={id:"#dialogModal",dialog:{}},l.file=null,l.serializedChapterForExport=null,l.serializedChapterForVisualisation=null,l.exportedFileName=null,l.showDialogModal=function(i){angular.copy(i,l.dialogModal.dialog),$(l.dialogModal.id).modal()},l.saveDialog=function(i){var t={};angular.copy(i,t),t.id=t.id||e.newGuid();var o=_.findIndex(l.chapter.dialogs,{id:t.id});-1!=o?l.chapter.dialogs[o]=t:l.chapter.dialogs.push(t),$(l.dialogModal.id).modal("hide")},l.selectDialog=function(i){l.updateDialogWindowVisible,angular.copy(i,l.dialogModal.dialog)},l.deleteDialog=function(i){_.remove(l.chapter.dialogs,{id:i.id})},l.demoDialog=function(i){},l.saveToStorage=function(){n()},l.importChapter=function(){try{var i=angular.element("#toolbar-file-import")[0];if(0==i.files.length)throw new Error("No file selected");var t=i.files[0],e=new FileReader;e.onload=function(i){a(e.result)},e.readAsText(t)}catch(r){o.add("danger","Impossible to import : "+r.message)}},l.exportChapter=function(){try{l.serializedChapterForExport=encodeURIComponent(JSON.stringify(l.chapter)),l.exportedFileName=l.chapter.getFileName()}catch(i){o.add("danger","Error while exporting : "+i.message)}},l.resetChapter=function(){l.chapter=new t},l.updateSerializedChapterForVisualisation=function(){l.serializedChapterForVisualisation=JSON.stringify(l.chapter,void 0,2)}}app.controller("EditChapterController",i),i.$inject=["$location","Chapter","NotificationsRepository","Guid"]}(),app.factory("NotificationsRepository",function(){var i={};return i.list=[],i.add=function(t,o){i.list.push({type:t,message:o})},i}),function(){function i(i){var t=this;t.notifications=i.list,t.removeNotification=function(i){t.notifications.splice(i,1)}}app.controller("NotificationsController",i),i.$inject=["NotificationsRepository"]}(),function(){function i(){}app.controller("ToolbarController",i)}(),function(){app.factory("Guid",function(){return{newGuid:function(){var i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){var t=16*Math.random()|0,o="x"==i?t:3&t|8;return o.toString(16)});return i}}})}(),function(){app.factory("Slug",function(){return{slugify:function(i){return i.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")}}})}();
//# sourceMappingURL=dist.min.js.map
