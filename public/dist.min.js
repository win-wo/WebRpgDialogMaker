app=angular.module("WebRpgDialogMaker",["ngRoute"]),app.Data={},app.config(["$compileProvider",function(i){i.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|data):/)}]),app.config(["$routeProvider",function(i){i.when("/edit",{templateUrl:"public/services/edit/index.html",controller:"EditPageController",controllerAs:"EditPage"}).otherwise({redirectTo:"/edit"})}]),function(){function i(){var i=this;i.appName="Project Chaptr",i.chapter}app.controller("AppController",i)}(),app.factory("Notifications",function(){var i={};return i.list=[],i.add=function(o,a){i.list.push({type:o,message:a})},i}),function(){function i(i,o){function a(){var i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){var o=16*Math.random()|0,a="x"==i?o:3&o|8;return a.toString(16)});return i}function t(){try{return JSON.parse(localStorage.chapter)}catch(i){return null}}function e(){localStorage.chapter=JSON.stringify(l.chapter)}function r(i){try{var a=JSON.parse(JSON.parse(i));n(a),localStorage.chapter=i}catch(t){o.add("danger","File is not valid : "+t.message)}}function n(i){if(!i)throw new Error("Chapter is null");if(!i.id)throw new Error("Missing id");if(!i.name)throw new Error("Missing name");if(!i.number)throw new Error("Missing number");if(!i.language)throw new Error("Missing language");if(!i.dialogs)throw new Error("Missing dialogs")}var l=this;l.chapter=t()||{id:a(),name:null,number:null,language:null,dialogs:[]},l.dialogModal={id:"#dialogModal",dialog:{}},l.file=null,l.serializedChapterForExport=null,l.serializedChapterForVisualisation=null,l.showDialogModal=function(i){angular.copy(i,l.dialogModal.dialog),$(l.dialogModal.id).modal()},l.saveDialog=function(i){var o={};angular.copy(i,o),o.id=o.id||a();var t=_.findIndex(l.chapter.dialogs,{id:o.id});-1!=t?l.chapter.dialogs[t]=o:l.chapter.dialogs.push(o),$(l.dialogModal.id).modal("hide")},l.selectDialog=function(i){l.updateDialogWindowVisible,angular.copy(i,l.dialogModal.dialog)},l.deleteDialog=function(i){_.remove(l.chapter.dialogs,{id:i.id})},l.demoDialog=function(i){},l.saveToStorage=function(){e()},l.importChapter=function(){try{var i=angular.element("#toolbar-file-import")[0];if(0==i.files.length)throw new Error("No file selected");var a=i.files[0],t=new FileReader;t.onload=function(i){r(t.result)},t.readAsText(a)}catch(e){o.add("danger","Impossible to import : "+e.message)}},l.exportChapter=function(){try{localStorage.chapter&&(l.serializedChapterForExport=encodeURIComponent(JSON.stringify(localStorage.chapter)))}catch(i){o.add("danger","Impossible to export, please save your data first")}},l.resetChapter=function(){l.chapter={}},l.updateSerializedChapterForVisualisation=function(){l.serializedChapterForVisualisation=JSON.stringify(l.chapter,void 0,2)}}app.controller("EditPageController",i),i.$inject=["$location","Notifications"]}(),function(){function i(){}app.controller("ToolbarController",i)}(),function(){function i(i){var o=this;o.notifications=i.list,o.removeNotification=function(i){o.notifications.splice(i,1)}}app.controller("NotificationsController",i),i.$inject=["Notifications"]}();
//# sourceMappingURL=dist.min.js.map
