{"version":3,"sources":["app.js","data/nofiticationRepository.js","demo/demoPageController.js","edit/editPageController.js","manage/managePageController.js","models/dialogModel.js"],"names":["app","angular","module","Data","config","$compileProvider","aHrefSanitizationWhitelist","$routeProvider","when","templateUrl","controller","controllerAs","otherwise","redirectTo","AppController","nofiticationRepository","vm","this","appName","notifications","removeNotification","index","remove","$inject","factory","add","type","message","push","splice","DemoPageController","EditPageController","$location","DialogModel","generateGuid","guid","replace","c","r","Math","random","v","toString","getFromStorage","JSON","parse","localStorage","chapter","saveToStorage","stringify","newDialog","id","name","number","language","dialogs","addNewDialog","dialog","saveDialog","_","findIndex","selectDialog","deleteDialog","runDialog","path","ManagePageController","loadDataAsChapter","data","isChapterValid","error","Error","file","exportedData","importData","element","files","reader","FileReader","onload","e","result","readAsText","exportData","encodeURIComponent"],"mappings":"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","file":"dist.min.js","sourcesContent":["app = angular.module(\"WebRpgDialogMaker\", [\"ngRoute\"]);\r\napp.Data = {};\r\napp.config(['$compileProvider', function ($compileProvider) {\r\n    $compileProvider.aHrefSanitizationWhitelist(/^\\s*(https?|ftp|mailto|file|data):/);\r\n}]);\r\n\r\napp.config(['$routeProvider',\r\n    function ($routeProvider) {\r\n        $routeProvider.\r\n            when('/manage', {\r\n                templateUrl: 'public/services/manage/index.html',\r\n                controller: 'ManagePageController',\r\n                controllerAs: 'ManagePage'\r\n            }).\r\n            when('/edit/', {\r\n                templateUrl: 'public/services/edit/index.html',\r\n                controller: 'EditPageController',\r\n                controllerAs: 'EditPage'\r\n            }).\r\n            when('/demo/:dialogId', {\r\n                templateUrl: 'public/services/demo/index.html',\r\n                controller: 'DemoPageController',\r\n                controllerAs: 'DemoPage'\r\n            }).\r\n            otherwise({\r\n                redirectTo: '/manage'\r\n            });\r\n    }]);\r\n\r\n(function () {\r\n    app.controller(\"AppController\", AppController);\r\n\r\n    AppController.$inject = [\"NofiticationRepository\"];    \r\n    function AppController(nofiticationRepository) {\r\n        var vm = this;\r\n        vm.appName = \"Project Chaptr\";\r\n        debugger;\r\n        vm.notifications = nofiticationRepository.notifications;\r\n        \r\n        vm.removeNotification = function(index){\r\n            nofiticationRepository.remove(index);\r\n        }\r\n    }\r\n})();","(function () {\r\n    app.factory(\"NofiticationRepository\", function () {\r\n        return {\r\n            notifications: [],\r\n            add: function (type, message) {\r\n                debugger;\r\n                this.notifications.push({\r\n                    type: type,\r\n                    message: message\r\n                });\r\n            },\r\n            remove : function(index) {\r\n                this.notifications.splice();\r\n            }\r\n        }\r\n    });\r\n})();","(function () {\r\n    app.controller(\"DemoPageController\", DemoPageController);\r\n\r\n    function DemoPageController() {\r\n        var vm = this;\r\n    }\r\n})();","(function () {\r\n    app.controller(\"EditPageController\", EditPageController);\r\n    EditPageController.$inject = [\"$location\",\"DialogModel\"];\r\n    \r\n    function EditPageController($location, DialogModel) {\r\n        var vm = this;\r\n        vm.newDialog = {};\r\n        \r\n        vm.chapter = getFromStorage() || {\r\n            id : null,\r\n            name : null,\r\n            number : null,\r\n            language : null,\r\n            dialogs : []\r\n        };\r\n        \r\n        vm.addNewDialog = function(){\r\n            var dialog = new DialogModel();\r\n            \r\n            dialog.id = generateGuid();\r\n            dialog.name = vm.newDialog.name;\r\n            dialog.number = vm.newDialog.number;\r\n            dialog.language = vm.newDialog.language;\r\n            \r\n            vm.chapter.dialogs.push(dialog);\r\n            vm.newDialog = {};\r\n        }   \r\n             \r\n        vm.saveDialog = function(){\r\n            var dialog = new DialogModel();\r\n            \r\n            dialog.id = vm.newDialog.id;\r\n            dialog.name = vm.newDialog.name;\r\n            dialog.number = vm.newDialog.number;\r\n            dialog.language = vm.newDialog.language;\r\n            \r\n            var index = _.findIndex(vm.chapter.dialogs, {id : dialog.id});\r\n            if(index != -1){\r\n                vm.chapter.dialogs[index] = dialog;    \r\n            }\r\n        }\r\n        \r\n        vm.selectDialog = function(dialog){\r\n            vm.newDialog = dialog;\r\n        }\r\n        vm.deleteDialog = function(dialog){\r\n            _.remove(vm.chapter.dialogs, {id : dialog.id});\r\n        }\r\n        vm.runDialog = function(dialog){\r\n            $location.path(\"/demo/\" + dialog.id);\r\n        }\r\n        vm.saveToStorage = function(){\r\n            saveToStorage();\r\n        }\r\n        \r\n        function generateGuid(){\r\n            var guid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\r\n                var r = Math.random()*16|0, v = c == 'x' ? r : (r&0x3|0x8);\r\n                return v.toString(16);\r\n            });\r\n            return guid;\r\n        }\r\n        \r\n        function getFromStorage(){\r\n            return JSON.parse(localStorage.chapter);\r\n        }\r\n        \r\n        function saveToStorage(){\r\n            localStorage.chapter = JSON.stringify(vm.chapter);\r\n        }\r\n    }\r\n})();","(function () {\r\n    app.controller(\"ManagePageController\", ManagePageController);\r\n    ManagePageController.$inject = [\"NofiticationRepository\"];\r\n    \r\n    function ManagePageController(nofiticationRepository) {\r\n        var vm = this;\r\n        vm.file = null;\r\n        vm.exportedData = null;\r\n\r\n        vm.importData = function () {\r\n            var element = angular.element(\"#manage-page-file-import\")[0];\r\n            var file = element.files[0];\r\n            var reader = new FileReader();\r\n\r\n            reader.onload = function (e) {\r\n                loadDataAsChapter(reader.result);\r\n            };\r\n\r\n            reader.readAsText(file);\r\n        }\r\n\r\n        vm.exportData = function () {\r\n            try {\r\n                if (localStorage.chapter) {\r\n                    vm.exportedData = encodeURIComponent(JSON.stringify(localStorage.chapter));\r\n                }\r\n            } catch (error) {\r\n                nofiticationRepository.add(\"danger\", \"No chapter to export\");\r\n            }\r\n        }\r\n\r\n        function loadDataAsChapter(data) {\r\n            try {\r\n                var chapter = JSON.parse(data);\r\n\r\n                isChapterValid(chapter);\r\n                localStorage.chapter = data;\r\n                \r\n            } catch (error) {\r\n                nofiticationRepository.add(\"danger\", \"Data is not readable or invalid\");\r\n            }\r\n        }\r\n\r\n        function isChapterValid(chapter) {\r\n            if (!chapter) throw new Error(\"Chapter is null\");\r\n            if (!chapter.id) throw new Error(\"Missing id\");\r\n            if (!chapter.name) throw new Error(\"Missing name\");\r\n            if (!chapter.number) throw new Error(\"Missing number\");\r\n            if (!chapter.language) throw new Error(\"Missing language\");\r\n            if (!chapter.dialogs) throw new Error(\"Missing dialogs\");\r\n        }\r\n    }\r\n})();","(function () {\r\n    app.factory(\"DialogModel\", function () { return DialogModel })\r\n\r\n    function DialogModel() {\r\n        this.id = null;\r\n        this.name = null;\r\n        this.number = null;\r\n        this.language = null;\r\n    }\r\n})();"],"sourceRoot":"/source/"}